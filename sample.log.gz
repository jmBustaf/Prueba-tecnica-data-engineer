import gzip
import json
from datetime import datetime, timedelta
import random
import os

output_path = "data/sample.log.gz"
os.makedirs("data", exist_ok=True)

endpoints = ["/api/login", "/api/users", "/api/products", "/api/logout"]
status_codes = [200, 201, 400, 401, 404, 500, 502, 503]
base_time = datetime.utcnow()

with gzip.open(output_path, "wt", encoding="utf-8") as f:
    for i in range(1000):  # puedes subirlo a 1_000_000 luego
        log = {
            "timestamp": (base_time - timedelta(minutes=i)).isoformat() + "Z",
            "endpoint": random.choice(endpoints),
            "status_code": random.choice(status_codes),
            "response_time": random.randint(50, 1200)
        }
        f.write(json.dumps(log) + "\n")

print("âœ… Archivo sample.log.gz generado en /data")
